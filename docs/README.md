# E2M 소나 하드웨어 제어 프로토콜 문서

E2M 소나 하드웨어와 통신하기 위한 완전한 프로토콜 문서 및 구현 가이드입니다.

**버전**: 1.0
**최종 업데이트**: 2025-10-29
**상태**: ✅ 프로덕션 준비 완료

---

## 📚 문서 목록

### 1. [프로토콜 명세서](./E2M_SONAR_PROTOCOL_SPEC.md)
**대상**: 개발자 (상세 기술 문서)
**내용**:
- 완전한 프로토콜 사양
- 패킷 구조 상세 설명
- 모든 명령어 레퍼런스
- RX/TX 데이터 형식
- 바이트 레벨 파싱 가이드

**언제 읽어야 하나요?**
- 프로토콜의 모든 세부사항을 이해해야 할 때
- 바이트 단위 패킷 구조를 확인할 때
- 레퍼런스 문서가 필요할 때

---

### 2. [빠른 구현 가이드](./QUICK_IMPLEMENTATION_GUIDE.md) ⭐ 추천
**대상**: 앱 개발자 (실용적 구현 가이드)
**내용**:
- 5분 요약 (바로 시작 가능)
- 완전한 코드 예시 (JavaScript, Dart)
- UI 구현 예시
- 자주 하는 실수
- 디버깅 팁

**언제 읽어야 하나요?**
- 빠르게 구현을 시작하고 싶을 때
- 복사-붙여넣기 가능한 코드가 필요할 때
- 실무 구현 중 참고가 필요할 때

---

### 3. [테스트 보고서](./TEST_REPORT.md)
**대상**: 개발팀, QA 팀
**내용**:
- 전체 테스트 결과 (100% 성공)
- 성능 분석 및 벤치마크
- 주파수별 특성 분석
- 응답 시간 통계
- 권장사항

**언제 읽어야 하나요?**
- 프로토콜의 신뢰성을 확인하고 싶을 때
- 성능 특성을 이해해야 할 때
- QA 계획을 세울 때

---

## 🚀 빠른 시작

### 1단계: 연결
```javascript
const net = require('net');
const socket = net.createConnection({
  host: '192.168.4.1',
  port: 36001
});
```

### 2단계: 명령 전송
```javascript
// 270kHz로 주파수 변경
const packet = Buffer.from([0x03, 0x00, 0x02, 0x02]);
socket.write(packet);
```

### 3단계: 데이터 수신
```javascript
socket.on('data', (buffer) => {
  if (buffer[0] === 0xB4) {
    const depth = buffer.readFloatLE(116);
    console.log(`깊이: ${depth.toFixed(2)}m`);
  }
});
```

**더 자세한 내용은 [빠른 구현 가이드](./QUICK_IMPLEMENTATION_GUIDE.md)를 참고하세요!**

---

## 📋 명령어 치트시트

### 패킷 형식
```
[0x03] [0x00] [CMD_ID] [PARAM]
```

### 주요 명령어
| 명령 | 패킷 | 설명 |
|------|------|------|
| 주파수 270kHz | `03 00 02 02` | 중간 깊이 스캔 |
| 주파수 100kHz | `03 00 02 03` | 깊은 수심 스캔 |
| 보트 모드 | `03 00 01 02` | 일반 낚시 모드 |
| 얼음 모드 | `03 00 01 03` | 빙상 낚시 모드 |
| 스캔 10Hz | `03 00 03 0a` | 초당 10회 스캔 |
| 스캔 정지 | `03 00 05 02` | 스캔 중지 |
| 스캔 시작 | `03 00 05 01` | 스캔 재개 |

---

## 🎯 어떤 문서를 읽어야 할까요?

### 새로운 개발자
1. ✅ [빠른 구현 가이드](./QUICK_IMPLEMENTATION_GUIDE.md) 먼저 읽기
2. ✅ 코드 예시를 복사해서 테스트
3. ✅ 필요할 때 [프로토콜 명세서](./E2M_SONAR_PROTOCOL_SPEC.md) 참조

### 경험 있는 개발자
1. ✅ [프로토콜 명세서](./E2M_SONAR_PROTOCOL_SPEC.md) 읽고 전체 구조 파악
2. ✅ [빠른 구현 가이드](./QUICK_IMPLEMENTATION_GUIDE.md)에서 코드 예시 참고
3. ✅ [테스트 보고서](./TEST_REPORT.md)에서 성능 특성 확인

### QA / 테스터
1. ✅ [테스트 보고서](./TEST_REPORT.md) 전체 읽기
2. ✅ [프로토콜 명세서](./E2M_SONAR_PROTOCOL_SPEC.md)에서 테스트 케이스 확인

---

## ✅ 검증 상태

### 테스트 완료 (2025-10-29)
- ✅ 주파수 변경 (675kHz, 270kHz, 100kHz)
- ✅ 모드 변경 (보트, 얼음)
- ✅ 스캔 주기 변경 (10Hz)
- ✅ 깊이 범위 설정 (50m)
- ✅ 스캔 제어 (시작/정지)

**성공률**: 100% (14/14 명령)
**응답 시간**: 평균 193.6ms
**안정성**: 매우 우수

---

## 🔧 기술 스택

### 지원하는 플랫폼
- ✅ Node.js / JavaScript
- ✅ Flutter / Dart
- ✅ React Native
- ⚠️ 기타 TCP 소켓 지원 플랫폼

### 필요한 기술
- TCP/IP 소켓 통신
- 바이너리 데이터 처리
- Float (Little-endian) 파싱

---

## 📊 성능 특성

### 주파수별 특성
| 주파수 | 깊이 범위 | 정밀도 | 용도 |
|-------|----------|-------|------|
| 675kHz | 0~3m | ±1.8cm | 얕은 수심, 정밀 측정 |
| 270kHz | 3~10m | ±27cm | 일반 낚시 |
| 100kHz | 10m+ | ±2.8m | 깊은 수심 |

### 스캔 주기
- 1~15Hz 설정 가능
- 권장: 5~10Hz (배터리 수명 고려)
- 10Hz 시 패킷 간격: 100ms ± 6.4ms

---

## 🛠️ 개발 도구

### E2M Sonar Debug Tool
Windows 앱으로 모든 명령을 GUI에서 테스트할 수 있습니다.

**GitHub**: https://github.com/easthyuk/e2m-sonar-debug-tool

**기능**:
- 실시간 스캔 데이터 모니터링
- 모든 제어 명령 GUI 버튼
- HEX 패킷 로그 확인
- CSV 로그 저장

---

## 📞 문의

### 하드웨어 제조사
**회사**: 케이제이알앤디
**담당**: 전승표

### 프로토콜 개발
**회사**: E2M
**테스트 완료일**: 2025-10-29

---

## 📄 라이선스

이 문서는 E2M과 케이제이알앤디의 협력으로 작성되었습니다.

---

## 📝 변경 이력

| 버전 | 날짜 | 변경 사항 |
|------|------|----------|
| 1.0 | 2025-10-29 | 초기 문서 작성, 프로토콜 검증 완료 |

---

## 🎉 시작하기

**지금 바로 [빠른 구현 가이드](./QUICK_IMPLEMENTATION_GUIDE.md)를 읽고 시작하세요!**

질문이 있으시면 [프로토콜 명세서](./E2M_SONAR_PROTOCOL_SPEC.md)를 참고하세요.
